<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed Deposit Record</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h2, h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #e0e0e0;
            padding: 10px;
            text-align: left;
        }
        th {
            background: #3498db;
            color: #fff;
            font-weight: 600;
        }
        .sortable {
            cursor: pointer;
            position: relative;
        }
        .sortable::after {
            content: 'â†•';
            margin-left: 5px;
            font-size: 12px;
        }
        button {
            margin: 5px;
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            background: #2ecc71;
            color: #fff;
            cursor: pointer;
            transition: background 0.3s, transform 0.1s;
            font-size: 14px;
        }
        button:hover {
            background: #27ae60;
            transform: scale(1.05);
        }
        button:active {
            transform: scale(0.95);
        }
        #accountHolderSelect, select, input[type="text"], input[type="number"], input[type="date"], input[type="file"] {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
            width: 100%;
            max-width: 300px;
            box-sizing: border-box;
        }
        .interest-section, .saved-interest-section, .summary-section, .calendar-section {
            margin-top: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        .form-group {
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        .form-group label {
            flex: 1 1 100%;
            font-weight: 500;
            color: #34495e;
        }
        .hidden {
            display: none;
        }
        .renewal-green { color: #27ae60; }
        .renewal-yellow { color: #f1c40f; }
        .renewal-red { color: #e74c3c; animation: blinker 1s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
        .expired-circle::after { content: " ðŸ”´"; }
        .certificate-obtained { color: #27ae60; }
        .certificate-not-obtained { color: #e74c3c; }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background: #34495e;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        .summary-section, .calendar-section {
            background: #ecf0f1;
        }
        .calendar-list { list-style: none; padding: 0; }
        .calendar-list li { margin: 8px 0; color: #7f8c8d; }
        footer {
            text-align: center;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 12px;
        }
        #passwordModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        #passwordModal div {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        #chartContainer {
            margin-top: 20px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        @media (max-width: 768px) {
            .container { padding: 15px; }
            .form-group { flex-direction: column; align-items: stretch; }
            .form-group label { flex: 1 1 auto; }
            input, select { max-width: 100%; }
            button { width: 100%; max-width: 200px; margin: 5px auto; }
            table { font-size: 12px; }
            th, td { padding: 8px; }
            .interest-section, .saved-interest-section, .summary-section, .calendar-section { padding: 15px; }
        }
        @media (max-width: 480px) {
            h2 { font-size: 1.2em; }
            button { font-size: 12px; padding: 6px 12px; }
            table { font-size: 10px; }
            th, td { padding: 6px; }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div id="passwordModal" class="hidden">
        <div>
            <h3>Set or Enter Password</h3>
            <input type="password" id="passwordInput" placeholder="Enter Password">
            <button id="submitPassword">Submit</button>
            <p id="passwordError" style="color: red;"></p>
        </div>
    </div>
    <div class="container hidden" id="mainContent">
        <div class="form-group">
            <label>Account Holder:
                <select id="accountHolderSelect"></select>
                <input type="text" id="newAccountHolder" placeholder="New Account Holder">
                <button id="addAccountHolderBtn">Add Account Holder</button>
            </label>
        </div>
        <h2>Fixed Deposit Record - <span id="accountHolderNameDisplay"></span></h2>

        <div class="form-group">
            <label>Search: <input type="text" id="searchInput" placeholder="Search by Bank Name or Amount"></label>
            <button id="backupDataBtn">Backup Data</button>
            <button id="bulkDeleteBtn">Delete Selected</button>
            <button id="bulkExportBtn">Export Selected</button>
        </div>

        <div class="form-group">
            <label class="tooltip">Bank Name: <span class="tooltiptext">Select the bank for FD</span>
                <select id="bankName">
                    <option value="Nabil Bank">Nabil Bank</option>
                    <option value="Nepal Investment Bank">Nepal Investment Bank</option>
                    <option value="Standard Chartered Bank">Standard Chartered Bank</option>
                    <option value="NIC Asia Bank">NIC Asia Bank</option>
                    <option value="Himalayan Bank">Himalayan Bank</option>
                    <option value="Global IME Bank">Global IME Bank</option>
                    <option value="Siddhartha Bank">Siddhartha Bank</option>
                    <option value="Prime Commercial Bank">Prime Commercial Bank</option>
                    <option value="Everest Bank">Everest Bank</option>
                    <option value="Citizens Bank">Citizens Bank</option>
                    <option value="Sanima Bank">Sanima Bank</option>
                    <option value="Kumari Bank">Kumari Bank</option>
                    <option value="Laxmi Bank">Laxmi Bank</option>
                    <option value="Machhapuchchhre Bank">Machhapuchchhre Bank</option>
                    <option value="Mega Bank">Mega Bank</option>
                    <option value="Sunrise Bank">Sunrise Bank</option>
                    <option value="NMB Bank">NMB Bank</option>
                    <option value="Prabhu Bank">Prabhu Bank</option>
                    <option value="Civil Bank">Civil Bank</option>
                    <option value="Century Commercial Bank">Century Commercial Bank</option>
                </select>
            </label>
            <label class="tooltip">Amount: <input type="number" id="amount" min="0" step="0.01"><span class="tooltiptext">Enter FD amount</span></label>
            <label class="tooltip">Duration: <span class="tooltiptext">Set FD duration</span>
                <input type="number" id="duration" min="1">
                <select id="durationUnit">
                    <option value="Days">Days</option>
                    <option value="Months">Months</option>
                    <option value="Years">Years</option>
                </select>
            </label>
            <label class="tooltip">Interest Rate (% per annum): <input type="number" id="interestRate" min="0" step="0.1" value="5"><span class="tooltiptext">Annual interest rate</span></label>
            <label class="tooltip">FD Start Date: <input type="date" id="fdStartDate" max=""><span class="tooltiptext">FD start date (up to today)</span></label>
            <label class="tooltip">FD Certificate: <span class="tooltiptext">Certificate status</span>
                <select id="fdCertificate">
                    <option value="obtained">Obtained</option>
                    <option value="not obtained">Not Obtained</option>
                </select>
            </label>
            <input type="hidden" id="editIndex">
            <button id="saveRecordBtn">Save Record</button>
            <button id="clearAllRecordsBtn">Clear All</button>
            <button id="exportToPDFBtn">Export to PDF</button>
            <button id="exportToExcelBtn">Export to Excel</button>
            <label>Import from Excel: <input type="file" id="importExcelFile" accept=".xlsx, .xls"></label>
            <button id="importExcelBtn">Import</button>
            <p>Estimated Interest: <span id="interestPreview">0</span></p>
        </div>

        <table>
            <thead>
                <tr>
                    <th><input type="checkbox" id="selectAll"></th>
                    <th class="sortable" data-sort="bankName">Bank Name</th>
                    <th class="sortable" data-sort="amount">Amount</th>
                    <th class="sortable" data-sort="duration">Duration</th>
                    <th>Duration Unit</th>
                    <th class="sortable" data-sort="interestRate">Interest Rate</th>
                    <th class="sortable" data-sort="fdStartDate">FD Start Date</th>
                    <th class="sortable" data-sort="fdMaturityDate">FD Maturity Date</th>
                    <th class="sortable" data-sort="fdRenewalDaysRemaining">FD Renewal Days</th>
                    <th class="sortable" data-sort="interest">Interest</th>
                    <th class="sortable" data-sort="fdCertificate">FD Certificate</th>
                    <th class="sortable" data-sort="status">Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="records"></tbody>
        </table>

        <div class="calendar-section">
            <h3>Upcoming Maturities</h3>
            <ul class="calendar-list" id="maturityCalendar"></ul>
        </div>

        <div class="interest-section">
            <h2>Interest Calculation</h2>
            <div class="form-group">
                <label>Select FD Record: <select id="fdRecordSelect"></select></label>
                <label>Bank Name: <input type="text" id="interestBankName" readonly></label>
                <label>Amount: <input type="number" id="interestAmount" readonly></label>
                <label>Interest Calculation Period:
                    <select id="interestCalculationPeriod">
                        <option value="whole">Whole FD Period</option>
                        <option value="custom">Custom Date Range</option>
                        <option value="fullCustom">Full Custom Input</option>
                    </select>
                </label>
                <label class="hidden" id="customInterestAmountLabel">Amount: <input type="number" id="customInterestAmount" min="0" step="0.01"></label>
                <label class="hidden" id="customInterestRateLabel">Interest Rate (% per annum): <input type="number" id="customInterestRate" min="0" step="0.1"></label>
                <label class="hidden" id="customInterestDurationLabel">Duration: <input type="number" id="customInterestDuration" min="1"></label>
                <label class="hidden" id="customInterestDurationUnitLabel">
                    <select id="customInterestDurationUnit">
                        <option value="Days">Days</option>
                        <option value="Months">Months</option>
                        <option value="Years">Years</option>
                    </select>
                </label>
                <label class="hidden">From Date: <input type="date" id="interestFromDate"></label>
                <label class="hidden">To Date: <input type="date" id="interestToDate"></label>
                <button id="calculateInterestBtn">Calculate Interest</button>
                <p>Calculated Interest: <span id="calculatedInterest">0</span></p>
            </div>
        </div>

        <div class="saved-interest-section">
            <h2>Saved Interest Records</h2>
            <table class="saved-interest-table">
                <thead>
                    <tr>
                        <th>Account Holder</th>
                        <th>Bank Name</th>
                        <th>Amount</th>
                        <th>Interest Rate</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Interest Calculation Period</th>
                        <th>Interest</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="savedInterestList"></tbody>
            </table>
            <button id="clearAllSavedInterestBtn">Clear All</button>
            <button id="exportSavedInterestToPDFBtn">Export to PDF</button>
            <button id="exportSavedInterestToExcelBtn">Export to Excel</button>
        </div>

        <div class="summary-section">
            <h3>Portfolio Summary</h3>
            <p>Total Investment: <span id="totalInvestment">0</span></p>
            <p>Total Interest Expected: <span id="totalInterest">0</span></p>
            <p>Active FDs: <span id="activeFDs">0</span></p>
            <p>Matured FDs: <span id="maturedFDs">0</span></p>
            <div id="bankBreakdown"></div>
            <button id="generatePieChartBtn">Generate Pie Chart</button>
            <div id="chartContainer" class="hidden">
                <canvas id="pieChart"></canvas>
            </div>
        </div>
    </div>
    <footer>
        Software concept and designed by - Santosh Phuyal
    </footer>

    <script>
        let inactivityTimer;
        const INACTIVITY_TIMEOUT = 15 * 60 * 1000; // 15 minutes in milliseconds
